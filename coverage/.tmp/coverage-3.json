{"result":[{"scriptId":"757","url":"file:///F:/pb/pb-mcpgateway/src/tests/auth/AuthenticationLayerImpl.test.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":53371,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":53371,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":532,"endOffset":18101,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":628,"endOffset":1603,"count":33}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1640,"endOffset":1697,"count":33}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1751,"endOffset":2411,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":1829,"endOffset":2012,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2111,"endOffset":2405,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2479,"endOffset":4496,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2524,"endOffset":2675,"count":4}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":2749,"endOffset":3173,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3252,"endOffset":3588,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":3668,"endOffset":4057,"count":1},{"startOffset":3788,"endOffset":4051,"count":3}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4126,"endOffset":4490,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4566,"endOffset":7585,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4611,"endOffset":4764,"count":5}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4838,"endOffset":5485,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5550,"endOffset":5924,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":5996,"endOffset":6534,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":6597,"endOffset":7145,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7222,"endOffset":7579,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7649,"endOffset":9240,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7694,"endOffset":7836,"count":3}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":7915,"endOffset":8257,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":8346,"endOffset":8798,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":8877,"endOffset":9234,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":9296,"endOffset":11300,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":9364,"endOffset":9668,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":9731,"endOffset":9943,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10010,"endOffset":10286,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10125,"endOffset":10161,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10341,"endOffset":10596,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10662,"endOffset":11294,"count":1},{"startOffset":11036,"endOffset":11166,"count":3}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10917,"endOffset":10953,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":11358,"endOffset":13360,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":11420,"endOffset":11823,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":11888,"endOffset":12098,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":12172,"endOffset":12317,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":12374,"endOffset":12732,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":12788,"endOffset":13354,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13419,"endOffset":14300,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13493,"endOffset":13824,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13894,"endOffset":14059,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":14126,"endOffset":14294,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":14354,"endOffset":16171,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":14436,"endOffset":14977,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":15059,"endOffset":16165,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":15476,"endOffset":15534,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":16224,"endOffset":16966,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":16302,"endOffset":16740,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":16818,"endOffset":16960,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":17019,"endOffset":18097,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":17092,"endOffset":17560,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":17637,"endOffset":18091,"count":1}],"isBlockCoverage":true}]},{"scriptId":"759","url":"file:///F:/pb/pb-mcpgateway/src/auth/AuthenticationLayerImpl.ts","functions":[{"functionName":"","ranges":[{"startOffset":0,"endOffset":55328,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":13,"endOffset":55328,"count":1}],"isBlockCoverage":true},{"functionName":"<instance_members_initializer>","ranges":[{"startOffset":449,"endOffset":15198,"count":49}],"isBlockCoverage":true},{"functionName":"AuthenticationLayerImpl","ranges":[{"startOffset":504,"endOffset":633,"count":49}],"isBlockCoverage":true},{"functionName":"authenticate","ranges":[{"startOffset":885,"endOffset":2339,"count":18},{"startOffset":1073,"endOffset":1191,"count":8},{"startOffset":1200,"endOffset":1333,"count":6},{"startOffset":1316,"endOffset":1333,"count":5},{"startOffset":1342,"endOffset":1626,"count":3},{"startOffset":1400,"endOffset":1495,"count":1},{"startOffset":1495,"endOffset":1609,"count":2},{"startOffset":1635,"endOffset":1756,"count":1},{"startOffset":1764,"endOffset":1793,"count":17},{"startOffset":1793,"endOffset":1971,"count":10},{"startOffset":1971,"endOffset":2140,"count":7},{"startOffset":2140,"endOffset":2170,"count":17},{"startOffset":2170,"endOffset":2335,"count":1}],"isBlockCoverage":true},{"functionName":"generateToken","ranges":[{"startOffset":2342,"endOffset":3087,"count":9},{"startOffset":2531,"endOffset":2590,"count":5},{"startOffset":2590,"endOffset":2668,"count":4}],"isBlockCoverage":true},{"functionName":"revokeToken","ranges":[{"startOffset":3090,"endOffset":3398,"count":1},{"startOffset":3183,"endOffset":3210,"count":0}],"isBlockCoverage":true},{"functionName":"createApiKey","ranges":[{"startOffset":3401,"endOffset":3799,"count":7}],"isBlockCoverage":true},{"functionName":"revokeApiKey","ranges":[{"startOffset":3802,"endOffset":4098,"count":1},{"startOffset":3895,"endOffset":3922,"count":0}],"isBlockCoverage":true},{"functionName":"validatePermissions","ranges":[{"startOffset":4101,"endOffset":4368,"count":0}],"isBlockCoverage":false},{"functionName":"hasPermission","ranges":[{"startOffset":4371,"endOffset":5000,"count":4},{"startOffset":4459,"endOffset":4485,"count":1},{"startOffset":4485,"endOffset":4525,"count":3},{"startOffset":4525,"endOffset":4551,"count":1},{"startOffset":4551,"endOffset":4793,"count":2},{"startOffset":4793,"endOffset":4814,"count":0},{"startOffset":4866,"endOffset":4995,"count":1}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":4893,"endOffset":4989,"count":1},{"startOffset":4934,"endOffset":4989,"count":0}],"isBlockCoverage":true},{"functionName":"validateToken","ranges":[{"startOffset":5066,"endOffset":5240,"count":6},{"startOffset":5196,"endOffset":5236,"count":0}],"isBlockCoverage":true},{"functionName":"validateApiKey","ranges":[{"startOffset":5243,"endOffset":5360,"count":3}],"isBlockCoverage":true},{"functionName":"cleanupExpiredTokens","ranges":[{"startOffset":5424,"endOffset":5499,"count":1}],"isBlockCoverage":true},{"functionName":"rateLimitCheck","ranges":[{"startOffset":5554,"endOffset":5636,"count":0}],"isBlockCoverage":false},{"functionName":"checkRateLimit","ranges":[{"startOffset":5691,"endOffset":5746,"count":2}],"isBlockCoverage":true},{"functionName":"authorize","ranges":[{"startOffset":5775,"endOffset":5951,"count":0}],"isBlockCoverage":false},{"functionName":"createSession","ranges":[{"startOffset":5986,"endOffset":6480,"count":0}],"isBlockCoverage":false},{"functionName":"validateSession","ranges":[{"startOffset":6483,"endOffset":6926,"count":0}],"isBlockCoverage":false},{"functionName":"revokeSession","ranges":[{"startOffset":6929,"endOffset":7159,"count":0}],"isBlockCoverage":false},{"functionName":"auditLog","ranges":[{"startOffset":7188,"endOffset":7395,"count":0}],"isBlockCoverage":false},{"functionName":"authenticateLocalTrusted","ranges":[{"startOffset":7398,"endOffset":7814,"count":9},{"startOffset":7493,"endOffset":7602,"count":2},{"startOffset":7602,"endOffset":7813,"count":7}],"isBlockCoverage":true},{"functionName":"authenticateExternalSecure","ranges":[{"startOffset":7817,"endOffset":8261,"count":8},{"startOffset":7900,"endOffset":8059,"count":3},{"startOffset":8009,"endOffset":8053,"count":1},{"startOffset":8059,"endOffset":8076,"count":5},{"startOffset":8076,"endOffset":8170,"count":3},{"startOffset":8170,"endOffset":8260,"count":2}],"isBlockCoverage":true},{"functionName":"validateTokenInternal","ranges":[{"startOffset":8264,"endOffset":9076,"count":8},{"startOffset":8361,"endOffset":8560,"count":4},{"startOffset":8560,"endOffset":9075,"count":2}],"isBlockCoverage":true},{"functionName":"validateApiKeyInternal","ranges":[{"startOffset":9079,"endOffset":9629,"count":6},{"startOffset":9176,"endOffset":9628,"count":3}],"isBlockCoverage":true},{"functionName":"isLocalTrusted","ranges":[{"startOffset":9632,"endOffset":10570,"count":12},{"startOffset":9690,"endOffset":9703,"count":0},{"startOffset":9789,"endOffset":9830,"count":11},{"startOffset":9868,"endOffset":9904,"count":0},{"startOffset":9934,"endOffset":9949,"count":8},{"startOffset":9950,"endOffset":9978,"count":7},{"startOffset":9980,"endOffset":9992,"count":5},{"startOffset":9992,"endOffset":10506,"count":7},{"startOffset":10344,"endOffset":10356,"count":1},{"startOffset":10356,"endOffset":10414,"count":6},{"startOffset":10414,"endOffset":10426,"count":1},{"startOffset":10426,"endOffset":10486,"count":5},{"startOffset":10486,"endOffset":10498,"count":1},{"startOffset":10506,"endOffset":10533,"count":4},{"startOffset":10533,"endOffset":10566,"count":0}],"isBlockCoverage":true},{"functionName":"toNum","ranges":[{"startOffset":10060,"endOffset":10140,"count":42}],"isBlockCoverage":true},{"functionName":"","ranges":[{"startOffset":10087,"endOffset":10130,"count":168},{"startOffset":10125,"endOffset":10129,"count":47}],"isBlockCoverage":true},{"functionName":"inRange","ranges":[{"startOffset":10166,"endOffset":10287,"count":18},{"startOffset":10258,"endOffset":10276,"count":6}],"isBlockCoverage":true},{"functionName":"checkPermissions","ranges":[{"startOffset":10573,"endOffset":10923,"count":0}],"isBlockCoverage":false},{"functionName":"generateSecureToken","ranges":[{"startOffset":10926,"endOffset":11019,"count":9}],"isBlockCoverage":true},{"functionName":"generateSecureApiKey","ranges":[{"startOffset":11022,"endOffset":11125,"count":56}],"isBlockCoverage":true},{"functionName":"initializeDefaults","ranges":[{"startOffset":11128,"endOffset":11859,"count":49},{"startOffset":11198,"endOffset":11293,"count":0},{"startOffset":11578,"endOffset":11602,"count":0},{"startOffset":11603,"endOffset":11644,"count":0},{"startOffset":11737,"endOffset":11782,"count":0}],"isBlockCoverage":true},{"functionName":"cleanupExpiredTokensInternal","ranges":[{"startOffset":11862,"endOffset":12236,"count":1},{"startOffset":12015,"endOffset":12128,"count":3}],"isBlockCoverage":true},{"functionName":"getActiveTokenCount","ranges":[{"startOffset":12290,"endOffset":12346,"count":0}],"isBlockCoverage":false},{"functionName":"getActiveApiKeyCount","ranges":[{"startOffset":12349,"endOffset":12407,"count":0}],"isBlockCoverage":false},{"functionName":"getTokenInfo","ranges":[{"startOffset":12410,"endOffset":12659,"count":0}],"isBlockCoverage":false},{"functionName":"getApiKeyInfo","ranges":[{"startOffset":12662,"endOffset":12901,"count":0}],"isBlockCoverage":false},{"functionName":"exportTokens","ranges":[{"startOffset":12953,"endOffset":13176,"count":0}],"isBlockCoverage":false},{"functionName":"exportApiKeys","ranges":[{"startOffset":13179,"endOffset":13402,"count":0}],"isBlockCoverage":false},{"functionName":"importTokens","ranges":[{"startOffset":13405,"endOffset":13757,"count":0}],"isBlockCoverage":false},{"functionName":"importApiKeys","ranges":[{"startOffset":13760,"endOffset":14106,"count":0}],"isBlockCoverage":false},{"functionName":"listApiKeys","ranges":[{"startOffset":14141,"endOffset":14538,"count":2},{"startOffset":14227,"endOffset":14515,"count":4}],"isBlockCoverage":true},{"functionName":"deleteApiKey","ranges":[{"startOffset":14541,"endOffset":14773,"count":0}],"isBlockCoverage":false},{"functionName":"listTokens","ranges":[{"startOffset":14808,"endOffset":15196,"count":0}],"isBlockCoverage":false},{"functionName":"get","ranges":[{"startOffset":15310,"endOffset":15349,"count":50}],"isBlockCoverage":true}]}]}